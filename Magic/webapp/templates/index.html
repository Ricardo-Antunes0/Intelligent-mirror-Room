<!DOCTYPE html>
<html>
<head>
    <title>Kafka Consumer Messages</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            setInterval(fetchMessagesTopic1, 200); // Fetch messages for topic1 every 2 seconds
            setInterval(fetchMessagesTopic2, 200); // Fetch messages for topic2 every 2 seconds

            function fetchMessagesTopic1() {
                $.ajax({
                    url: '/get_messages_topic1',
                    type: 'GET',
                    success: function(response) {
                        $('#messages_topic1').text(response.latest_message);
                    }
                });
            }

            function fetchMessagesTopic2() {
                $.ajax({
                    url: '/get_messages_topic2',
                    type: 'GET',
                    success: function(response) {
                        $('#messages_topic2').text(response.latest_message);
                    }
                });
            }
        });
    </script>
</head>
<body>
    <h1>Kafka Consumer Messages</h1>
    <h2>Topic 1:</h2>
    <div id="messages_topic1">
        <p>Loading messages for Topic 1...</p>
    </div>
    <h2>Topic 2:</h2>
    <div id="messages_topic2">
        <p>Loading messages for Topic 2...</p>
    </div>
</body>
</html>
